@using Pundit.Core
@using Pundit.Core.Server.Model
@using Pundit.Core.Utils
@model IEnumerable<DbPackage>
@{
    ViewBag.Title = "Packages";
}

@*Html.ActionLink("publish", "Publish")*@

<h2>History (last 100 submissions)</h2>

<table>
   <tr>
      <th>PackageId</th>
      <th>Version</th>
      <th>Platform</th>
      <th>Created</th>
      <th></th>
   </tr>
   @foreach (DbPackage p in Model)
   {
      string size = ByteFormat.ToString((ulong) p.FileSize);
      string fileName = PackageUtils.GetFileName(p.Package.Key);
      <tr>
         <td>@p.Package.PackageId</td>
         <td>@p.Package.Version</td>
         <td>@p.Package.Platform</td>
         <td>@p.CreatedDate</td>
         <td>
            @Html.ActionLink("download", "DownloadPackage", new { id = fileName })
            (@size)
         </td>
      </tr>
   }
</table>